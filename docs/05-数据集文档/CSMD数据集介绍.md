# CSMD 数据集介绍

CSMD（Curated Multimodal Dataset）是一个专门为中国股票市场设计的多模态数据集，整合了股票价格数据和金融新闻文本数据。该数据集由 LightQuant 团队整理发布，旨在为股票市场预测研究提供高质量的数据支持。CSMD 数据集已应用于相关学术研究，并被 CIKM 2025 会议接收，展现了其在学术界的认可度和实用价值。

## 数据集概述

### 设计理念

传统的股票预测研究通常只关注价格数据或只关注文本数据，难以全面捕捉市场的运行规律。CSMD 数据集的设计理念是通过整合价格和新闻两种模态的数据，为研究者提供更丰富的市场信息。价格数据反映了市场的历史走势和交易活动，是技术分析的基础；新闻文本包含了影响市场的各类信息，是基本面分析和情绪分析的重要来源。两者的结合能够更全面地描述市场状态，有助于构建更准确的预测模型。

数据收集过程中，团队严格筛选数据来源，确保数据的权威性和可靠性。价格数据来源于权威的金融数据提供商，新闻数据主要来自证券时报等官方媒体。所有数据都经过严格的清洗和预处理，包括缺失值处理、异常值检测、数据标准化等步骤，确保数据质量满足建模要求。

### 主要特性

CSMD 数据集具有以下五个主要特性：首先，数据整合度高，将股票价格和金融新闻文本有机整合，形成统一的多模态数据集，用户无需自行收集和整合数据。其次，数据质量优秀，所有数据都经过严格的筛选和预处理，确保数据的相关性和有效性。第三，因子提取增强，利用大语言模型从新闻文本中提取金融因子，显著提升了数据的可解释性和预测能力。第四，数据来源权威，新闻内容主要来自证券时报等官方媒体，确保信息的真实性和可信度。第五，预处理完善，数据经过精心的清洗和去噪处理，有效提升了数据质量和训练效率。

### 数据版本

目前公开发布的 CSMD 数据集包含两个版本：CSMD50 包含 50 只精选股票的数据，这些股票覆盖了金融、医药、制造、消费等多个行业，具有较好的市场代表性；CSMD300 包含 300 只股票的数据，涵盖范围更广，能够支持更大规模的研究实验。两个版本的数据格式完全相同，只是股票数量不同。用户可以根据研究需求选择合适的版本，资源有限时使用 CSMD50，研究大规模模型时使用 CSMD300。

## 数据内容详解

### 价格数据

价格数据是 CSMD 数据集的核心组成部分，记录了每只股票的 OHLCV（开盘价、最高价、最低价、收盘价、成交量）数据。每条价格记录包含以下字段：Date（日期，格式为 YYYY-MM-DD）、Open（开盘价）、High（最高价）、Low（最低价）、Close（收盘价）、Adj Close（调整后收盘价）、Volume（成交量）。数据按交易日排列，覆盖了 2021 年至 2024 年的时间范围。

价格数据的时间跨度设计考虑了多种研究需求：2021 年至 2024 年的数据包含了不同的市场环境，包括牛市、震荡市和熊市，有助于评估模型在不同市场条件下的表现。数据的更新频率为日度数据，每个交易日结束后更新前一个交易日的数据。这种频率平衡了数据量和预测意义，既提供了足够的样本数量，又保持了每个样本的信息价值。

### 新闻数据

新闻数据记录了与各股票相关的财经新闻，提供了影响股票价格的基本面信息和市场情绪。每条新闻记录包含以下字段：time（发布时间，格式为 YYYY-MM-DD HH:MM）、title（新闻标题）、content（新闻内容）、link（原文链接）。新闻数据与股票代码对应存放，便于进行股票级别的分析和建模。

新闻数据的时间覆盖与价格数据基本一致，确保在进行多模态分析时有足够的时间窗口。新闻来源主要是证券时报等权威媒体，确保信息的可信度。每只股票每天可能有 0 条到多条新闻记录，取决于当天的事件数量。新闻数据经过初步的去重和筛选，去除了广告、软文等低质量内容。

### 标签数据

标签数据是监督学习的目标变量，定义了对股票未来价格走势的预测任务。CSMD 数据集采用二分类标签：如果下一个交易日的收盘价高于当前交易日收盘价，标签为 1（上涨）；如果下一个交易日的收盘价低于或等于当前交易日收盘价，标签为 0（下跌或持平）。这种标签定义方式将股票预测问题转化为涨跌预测问题，是股票预测研究中常用的范式。

标签的计算公式为：Label = 1 if Close(t+1) > Close(t) else 0。需要注意的是，标签的计算使用收盘价而非开盘价，避免了日内波动对标签的影响。由于标签需要使用未来信息，在实际应用中需要使用历史数据来预测未来的标签，模拟真实的投资决策场景。

### 嵌入数据

嵌入数据是新闻文本经过模型编码后的向量表示，用于将非结构化的文本数据转化为模型可处理的数值向量。CSMD 数据集使用预训练的词向量模型（如 Word2Vec 或 BERT）将每条新闻转换为固定维度的向量。嵌入数据以 `.npy` 格式存储，便于快速加载和处理。

嵌入数据的生成过程包括：文本预处理，包括分词、去停用词、标点处理等；词向量生成，使用预训练模型获取每个词的向量表示；句子嵌入，将词向量聚合为句子级别的表示（如平均池化或使用 CLS token）。嵌入向量能够捕捉文本的语义信息，使模型能够在统一的向量空间中进行多模态融合分析。

## 数据集结构

### 目录结构

CSMD 数据集的目录结构组织如下：dataset/CSMD50/price/ 目录存放所有股票的价格数据 CSV 文件，每个文件以股票名称命名，如 `贵州茅台.csv`；dataset/CSMD50/news/ 目录存放新闻数据，按股票名称分文件夹组织，每个文件夹内是以日期命名的 CSV 文件；dataset/CSMD50/news_embedding/ 目录存放新闻嵌入数据，结构与新闻目录相同，但文件格式为 `.npy`。

### 文件格式

价格数据 CSV 文件的格式示例：第一行是列标题，包括 Date、Open、High、Low、Close、Adj Close、Volume、Label；从第二行开始是数据行，日期格式为 YYYY-MM-DD，数值保留两位小数或根据实际情况调整。文件使用 UTF-8 编码，确保中文正确显示。

新闻数据 CSV 文件的格式示例：第一行是列标题，包括 time、title、content、link；从第二行开始是数据行，时间格式为 YYYY-MM-DD HH:MM，标题和内容为文本字段。文件使用 UTF-8 编码，文本内容可能包含换行符，需要在读取时正确处理。

嵌入数据文件是 NumPy 的 `.npy` 格式，每个文件是一个二维 numpy 数组，形状为 (n_news, embedding_dim)，其中 n_news 是该股票该日新闻数量，embedding_dim 是嵌入维度。加载方式使用 numpy.load() 函数。

### 划分数据

项目提供了自动划分训练集、验证集和测试集的功能。默认的划分方式如下：训练集包含 2021-01-01 至 2024-03-14 的数据，作为模型学习的样本；验证集包含 2024-03-15 至 2024-08-07 的数据，用于模型选择和超参数调优；测试集包含 2024-08-08 至 2024-12-31 的数据，用于最终评估模型性能。

这种时间顺序划分方式模拟了真实的时间序列预测场景：模型只能使用历史数据来预测未来，不能"偷看"未来的信息。这种设置更贴近实际的投資场景，评估结果也更具有参考价值。用户可以通过修改 `utils/util.py` 中的日期配置来调整划分比例。

## 数据获取方法

### 下载地址

CSMD50 数据集可以从 Google Drive 下载，下载地址为项目主页提供的链接。CSMD300 数据集同样从 Google Drive 下载。两个数据集的文件较大，建议使用网络状况良好时下载，或使用下载工具支持断点续传。下载完成后，需要将文件解压到项目根目录下的 `dataset/` 文件夹中。

### 数据统计

CSMD50 数据集包含 50 只股票的完整数据，每只股票大约有 800-1000 个交易日的数据点。新闻数据方面，每只股票每天平均有 3-5 条新闻，总计约 15000 条新闻记录。CSMD300 数据集包含 300 只股票的数据，新闻记录总数约为 90000 条。具体数据量可能因数据更新而略有变化。

### 数据更新

CSMD 数据集发布后可能会进行更新，包括补充最新数据、修正已知问题等。建议用户定期关注项目主页的更新公告。如需获取最新数据，可以重新下载完整数据集或下载增量更新包。数据集的版本信息会记录在相关文档中，请注意核对使用的版本。

## 数据质量保证

### 数据来源

价格数据来源于权威的金融数据提供商，数据准确性有保障。新闻数据主要来自证券时报等官方财经媒体，内容质量和可信度较高。所有数据在入库前都经过质量检查，确保数据完整性和准确性。

### 预处理流程

数据集的预处理流程包括：数据清洗，去除重复记录、修复错误数据、填补缺失值；数据标准化，统一数据格式和编码，处理异常值；质量验证，检查数据的完整性和一致性。预处理流程中的关键步骤都已自动化，减少了人工操作带来的错误风险。

### 已知局限

尽管数据集已经过严格处理，但仍存在一些已知的局限性：新闻数据可能存在遗漏，特别是对于事件发生当晚发布的新闻；部分股票的新闻数量较少，可能影响多模态模型的效果；标签定义采用简单的涨跌二分法，可能无法完全反映市场复杂性。使用者在进行研究和应用时应注意这些局限性。

## 使用建议

### 数据加载

使用数据集时，建议遵循以下最佳实践：使用项目提供的数据加载器（utils/price_dataloader.py 和 utils/price_news_dataloader.py），这些加载器已正确处理数据格式和预处理；在训练前对数据进行标准化，确保模型能够有效学习；注意数据泄露问题，确保训练集和测试集按时间正确划分。

### 数据探索

在正式建模前，建议先进行探索性数据分析：分析价格数据的分布特征和自相关性；分析新闻数据的数量分布和时间模式；检查价格与新闻之间的时间对应关系；可视化数据分布，发现潜在的问题和模式。

### 基准对比

项目提供了多个基准模型的结果，包括 LSTM、BiLSTM、ALSTM、Adv-LSTM、SCINet、DTML、StockNet、HAN 和 PEN。建议在复现这些基准结果后，再进行改进实验，这样可以确保实验环境的一致性，也便于与已有工作进行公平对比。

## 相关论文

CSMD 数据集的相关研究成果已发表在 CIKM 2025 会议上。论文详细介绍了数据集的设计理念、构建方法和应用效果，提供了数据集在多个预测模型上的基准测试结果。引用该数据集进行研究的用户，建议同时引用相关论文。详细信息请参阅参考文献页面。
